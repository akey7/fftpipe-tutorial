---
title: "fftpipe Tutorial"
description: |
  How to use the fftpipe package for R.
author:
  - name: Alicia M. F. Key 
    url: https://scialicia.com
    affiliation: Personal Projects
    affiliation_url: https://scialicia.com
date: "`r Sys.Date()`"
output: distill::distill_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## What is fftpipe?

`fftpipe` is a package of functions that wrap around the base R [`fft()`](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/fft) function. The `fftpipe` package enables workflows around the [`fft()`](https://www.rdocumentation.org/packages/stats/versions/3.6.2/topics/fft) function that use the pipe (`%>%`) operator. I took inspiration for the interface to `fftpipe` from the [Tidyverse](https://www.tidyverse.org) and [tidymodels](https://www.tidymodels.org) packages.

Specifically, `fftpipe` offers the following functionality:

1. Waveform generation,
2. FFT and inverse FFT transformation,
3. Plotting of these waveforms and FFTs.

## Installation

Install `fftpipe` from GitHub with devtools. If you don't have devtools installed already, install it with `install.packages("devtools")`. Once devtools is installed, you can then install `fftpipe` by typing the following command into the R console:

```
devtools::install_github("akey7/fftpipe")
```

## Quick Start

More detail about each of these steps is described below in this document. But this will get you started!

### Load the necessary packages

While you can use `fftpipe` on its own, it is designed to work within the [Tidyverse](https://www.tidyverse.org) ecosystem, so I recommend you load the tidyverse as well. Also, I will set a theme for `ggplot()`.

```{r}
suppressPackageStartupMessages(library(fftpipe))
suppressPackageStartupMessages(library(tidyverse))
theme_set(theme_linedraw(base_size = 15))
```

### Generate a waveform

For the quick start demo, let's compose a waveform to feed into the FFT with the following properties:

1. Its duration will be 1 second with a sample rate of 200 samples/second.
2. It will be the sum of 2 cosines, with the second cosine being 3x the frequency and 50% the amplitude of the first cosine.
3. Its total amplitude will decrease with an exponential decay function, with an [exponential time constant (tau)](https://en.wikipedia.org/wiki/Exponential_decay#Mean_lifetime) of 0.5.

We can compose this waveform using functions from fftpipe as shown in this code block:

```{r}
wv <- waveform(duration_s = 1.0, sr = 200) %>%
  cos_sum(freqs = c(2.0, 6.0), amplitudes = c(1.0, 0.5)) %>%
  exp_decay(decay_tau = 0.5)
```

### Plot the input waveform

We can streamline plotting the input waveform with the following function call. This plot can be refined in ways I'll describe later in the document.

```{r}
waveform_plot(wv)
```

